<div id="feedbacks-table" class="overflow-x-auto">
  <table class="table-fixed w-full bg-white border border-gray-200 rounded shadow-sm" style="table-layout: fixed; word-break: break-word;">
    <colgroup>
      <col class="w-[5%]" />
      <col class="w-[15%]" />
      <col class="w-[40%]" />
      <col class="w-[10%]" />
      <col class="w-[10%]" />
      <col class="w-[10%]" />
      <col class="w-[10%]" />
    </colgroup>
    <thead class="bg-gray-100 text-sm font-semibold text-gray-700">
      <tr>
        <th class="px-3 py-2 text-left">ID</th>
        <th class="px-3 py-2 text-left">Ğ¢ĞµĞ¼Ğ°</th>
        <th class="px-3 py-2 text-left">Ğ—Ğ¼Ñ–ÑÑ‚</th>
        <th class="px-3 py-2 text-center">ĞœĞ¾Ğ²Ğ°</th>
        <th class="px-3 py-2 text-center">Ğ¡Ğ¿Ğ°Ğ¼</th>
        <th class="px-3 py-2 text-center">Ğ¡ĞµĞ½Ñ‚Ğ¸Ğ¼ĞµĞ½Ñ‚</th>
        <th class="px-3 py-2 text-center">Ğ¡ĞµĞºÑ€ĞµÑ‚</th>
      </tr>
    </thead>
    <tbody class="divide-y divide-gray-200 text-sm">
      {% for fb in feedbacks %}
      <tr class="hover:bg-gray-50">
        <td class="px-3 py-2 truncate">{{ fb[0] }}</td>
        <td class="px-3 py-2 font-semibold truncate" title="{{ fb[1] }}">{{ fb[1] }}</td>
        <td class="px-3 py-2">
          <div id="content-{{ fb[0] }}" class="break-words" data-text="{{ fb[2] }}">
            {% if fb[2]|length > 120 %}
              {{ fb[2][:120] }}â€¦
            {% else %}
              {{ fb[2] }}
            {% endif %}
          </div>
          {% if fb[2]|length > 120 %}
            <button data-id="{{ fb[0] }}" class="text-blue-500 text-xs mt-1 show-more-btn" type="button">
              ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚Ğ¸ Ğ±Ñ–Ğ»ÑŒÑˆĞµ
            </button>
          {% endif %}
        </td>
        <td class="px-3 py-2 text-center truncate">{{ fb[4] }}</td>
        <td class="px-3 py-2 text-center">{% if fb[6] == 1 %}<span title="Ğ¡Ğ¿Ğ°Ğ¼">ğŸš«</span>{% endif %}</td>
        <td class="px-3 py-2 text-center">
          {% set icons = {'very negative':'ğŸ˜¡','negative':'ğŸ˜','neutral':'ğŸ˜','positive':'ğŸ˜Š','very positive':'ğŸ˜„'} %}
          <span title="{{ fb[5] }}">{{ icons.get(fb[5]|lower, 'â”') }}</span>
        </td>
        <td class="px-3 py-2 text-center">
          <div class="inline-flex items-center space-x-1 justify-center">
            {% set icons_secret = {'very negative':'ğŸ˜¡','negative':'ğŸ˜','neutral':'ğŸ˜','positive':'ğŸ˜Š','very positive':'ğŸ˜„'} %}
            <span title="{{ fb[8] }}">{{ icons_secret.get(fb[8]|lower, 'â”') }}</span>
            {% if fb[9] == 1 %}<span title="Ğ¡Ğ¿Ğ°Ğ¼">ğŸš«</span>{% endif %}
            <button title="ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚Ğ¸ Ñ‚ĞµĞºÑÑ‚" class="text-blue-600 hover:text-blue-800 show-secret-btn" data-id="{{ fb[0] }}" data-code="{{ selected_institution or '' }}">ğŸ”’</button>
          </div>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- Ğ”ĞµĞ»ĞµĞ³ÑƒĞ²Ğ°Ğ½Ğ½Ñ ĞºĞ»Ñ–ĞºÑ–Ğ² Ğ´Ğ»Ñ Ğ´Ğ¸Ğ½Ğ°Ğ¼Ñ–Ñ‡Ğ½Ğ¸Ñ… Ñ‚Ğ°Ğ±Ğ»Ğ¸Ñ†ÑŒ -->
<script>
  document.body.addEventListener('click', function(event) {
    if (!event.target.classList.contains('show-more-btn')) return;
    const btn = event.target;
    const id = btn.getAttribute('data-id');
    const contentEl = document.getElementById('content-' + id);
    const fullText = contentEl.getAttribute('data-text');
    const isExpanded = btn.textContent.trim() === 'Ğ—Ğ³Ğ¾Ñ€Ğ½ÑƒÑ‚Ğ¸';
    contentEl.textContent = isExpanded ? fullText.slice(0, 120) + 'â€¦' : fullText;
    btn.textContent = isExpanded ? 'ĞŸĞ¾ĞºĞ°Ğ·Ğ°Ñ‚Ğ¸ Ğ±Ñ–Ğ»ÑŒÑˆĞµ' : 'Ğ—Ğ³Ğ¾Ñ€Ğ½ÑƒÑ‚Ğ¸';
  });
</script>